<html>
<head>
<style type="text/css">
body
{
    cursor: none;
/*    cursor: url(cursor1.png) 4 12, pointer;*/
    background-color: #000000;
}
td
{
    font-size: 26px;
    color: white;
    vertical-align: middle;
    line-height: 40px;
}
#password_entry {
    border: none;
    background: #000000;
    color: #ffffff;
    font-size: 26px;
    text-align: center;
}
</style>
<script type="text/javascript">


password_prompt = false;
//password_prompt = true;//mine
selected_user = null;
time_remaining = 0

function show_prompt(text)
{
   password_prompt = true;

   label = document.getElementById('password_prompt');
   label.innerHTML = text;
   
   user_table = document.getElementById('user_table');   
   for (i in user_table.rows)
   {
       row = user_table.rows[i];
       if (row.id != ('user_' + selected_user) && row.style != null) // FIXME: Don't know why there are rows with styles
           row.style.opacity = 0.25;
   }

   entry = document.getElementById('password_entry');
   entry.value = '';

   table = document.getElementById('password_table');
   table.style.visibility = "visible";

   entry.focus();
}

function show_message(text)
{
   table = document.getElementById('message_table');
   label = document.getElementById('message_label');
   label.innerHTML = text;
   if (text.length > 0)
       table.style.visibility = "visible";
   else
       //table.style.visibility = "hidden";
       table.style.visibility = "visible";//mine
}

function show_error(text)
{
   show_message (text);
}

function reset()
{
   user_table = document.getElementById('user_table');   
   for (i in user_table.rows)
   {
       row = user_table.rows[i];
       if (row.style != null) // FIXME: Don't know why there are rows with styles
           row.style.opacity = 1;
   }
   table = document.getElementById('password_table');
   //table.style.visibility = "hidden";
   table.style.visibility = "visible";//mine
   password_prompt = false;
}

loading_text = ''

function throbber()
{
   loading_text += '.';
   if (loading_text == '....')
       loading_text = '.'
   label = document.getElementById('countdown_label');
   label.innerHTML = loading_text;
   setTimeout('throbber()', 1000);
}

function authentication_complete()
{
   if (lightdm.is_authenticated)
       lightdm.login (lightdm.authentication_user, lightdm.default_session);
   else
       show_message ("Authentication Failed");

   reset ();
   setTimeout('throbber()', 1000);
}

function timed_login(user)
{
   lightdm.login (lightdm.timed_login_user);
   setTimeout('throbber()', 1000);
}

function start_authentication(username)
{
   lightdm.cancel_timed_login ();
   label = document.getElementById('countdown_label');
   if (label != null)
       label.style.visibility = "hidden";

   show_message("");
   if (!password_prompt) {
       selected_user = username;
       lightdm.start_authentication(username);
   }
}

function provide_secret()
{
   entry = document.getElementById('password_entry');
   lightdm.provide_secret(entry.value);
}

function countdown()
{
   label = document.getElementById('countdown_label');
   label.innerHTML = ' in ' + time_remaining + ' seconds'
   time_remaining--;
   if (time_remaining >= 0)
       setTimeout('countdown()', 1000);
}
//function mouse_inv()
//{
//    document.body.style.cursor
document.write('<table id="user_table" style="width:100%; margin-top: 350px; ">');
//document.write('<table onload="start_authentication(\'' + user.name + '\')" id="user_table" style="margin: auto;">');//mine_j

for (i in lightdm.users)
{
   user = lightdm.users[i];

   if (user.image.length > 0)
      image = user.image
   else
      image = 'file:///home/arno/Pictures/Non-official-icons/login_icon.png'

   document.write('<tr id="user_' + user.name +'"onclick="start_authentication(\'' + user.name + '\')" style="cursor: none;">');
//   document.write('<tr id="user_' + user.name +'start_authentication(\'' + user.name + '\')" style="cursor: pointer;">');//mine
//   document.write('<td><img width="48px" height="48px" src="' + image + '" /></td>');
//   document.write('<td>' + user.display_name + '</td>');
   document.write('<td style="width:100%; text-align: center;">' + user.display_name + '</td>');//mine
   if (user.name == lightdm.timed_login_user && lightdm.timed_login_delay > 0)
       document.write('<td id="countdown_label"></td>');
   document.write('</tr>');
}
document.write('</table>');
document.write('<table id="message_table" style="margin: auto; visibility: hidden;"><td id="message_label"></td></table>');
document.write('<table id="password_table" style="margin: auto; visibility: hidden; color: red;"><tr>');
//document.write('<table id="message_table" style="margin: auto; visibility: visible;"><td id="message_label"></td></table>'); //mine
//document.write('<table id="password_table" style="margin: auto; visibility: visible; color: red;"><tr>'); //mine
document.write('<td style="display: none;" id="password_prompt"></td>');//Per avere di nuovo "Password", togliere style="display: none;"
document.write('<td><form action="javascript: provide_secret()"><input id="password_entry" type="password" /></form></td>');
document.write('</tr></table>');
//document.body.style.cursor = 'none';//mine
start_authentication(user.name);
time_remaining = lightdm.timed_login_delay;
if (time_remaining > 0)
    countdown();
</script>
</head>

<body>
</body>

</html>
